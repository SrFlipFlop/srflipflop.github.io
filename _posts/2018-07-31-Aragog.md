---
layout: post
title: "HackTheBox Aragog"
date: 2018-07-31 
description: "Writeup of Aragog HackTheBox machine"
tag: CTF
---   

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas ut efficitur nisi. Nullam non risus a orci ultrices lacinia ac a purus. Etiam in imperdiet lectus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Cras ultrices tellus quis sapien mollis, in luctus tortor tempor. Suspendisse potenti. Curabitur sit amet porta magna. Duis dignissim risus at scelerisque malesuada. Integer venenatis quis augue eget pellentesque. Phasellus iaculis sed lacus quis efficitur.

### Information gathering

Starting as allways, we first use **nmap** to analyze the public services. As we can see in the output, the machine only have the 3 most common ports.

![](/images/posts/Aragog/img1.png "nmap scan")

**nmap** with *-sC* option also launches the default NSE scripts, and one of these checks the authentication with the anonymous user in the FTP server. In the FTP service we only see one file with XML content related with network masks.

![](/images/posts/Aragog/img2.png "FTP service")



![](/images/posts/Aragog/img3.png "Default Apache page")

![](/images/posts/Aragog/img4.png "Web enumeration")

![](/images/posts/Aragog/img5.png "HTTP normal request")

![](/images/posts/Aragog/img6.png "Request with the XML resource")

![](/images/posts/Aragog/img7.png "XXE test")

![](/images/posts/Aragog/img8.png "LFI using the XXE")

![](/images/posts/Aragog/img9.png "Extract SSH key")

![](/images/posts/Aragog/img11.png "Connection with SSH")

![](/images/posts/Aragog/img12.png "Suspicious files with write permission")

![](/images/posts/Aragog/img13.png "Database password in the web application source code")

![](/images/posts/Aragog/img14.png "Databases in the MySQL server")

![](/images/posts/Aragog/img15.png "Administrator password")

![](/images/posts/Aragog/img16.png "Blog")

![](/images/posts/Aragog/img17.png "Wordpress admin login")

![](/images/posts/Aragog/img18.png "Blog entry")

![](/images/posts/Aragog/img19.png "Web code modifyed")

![](/images/posts/Aragog/img20.png "Administrator password loged")

![](/images/posts/Aragog/img21.png "Privilege escalation")
